--- TB2KD.ASM	2018-01-30 19:54:47
+++ BASIC.S	2025-07-11 13:48:26
@@ -1,13 +1,16 @@
-* 2018/01/24
-* STACK		$1F47 : $A047
-* SUBSTK	$1F80 : $A080
 *
-ACIACS	EQU	$8018
-RAMSSS	EQU	$0980
-RAMEEE	EQU	$1EFF
+IPRORG	EQU	$1000
+BUFORG	EQU	$400
+RAMTOP	EQU	$2000
+RAMEND	EQU	8
+NMISET	EQU	$FFE6
+NMICLR	EQU	$FFE9
 *
-	NAM	FIRST
-	ORG	$1A
+* DENDAI
+* TINY BASIC
+*   FOR MB6881.][
+*
+	ORG	$7A
 V	RMB	2
 W	RMB	2
 Z	RMB	2
@@ -21,171 +24,138 @@
 AFLG	RMB	1
 CHCNT	RMB	1
 F	RMB	1
-BUFFER	RMB	80
-EXSTK	EQU	*
-EXSP	RMB	2
-	RMB	52
 PRSTRT	RMB	2
 PREND	RMB	2
-RAMEND	RMB	2
+*
 SUBSP	RMB	2
+*
+	ORG	$500
 FORSP	RMB	2
 	RMB	64
 FORSTK	EQU	*
-STACK	EQU	$1F47	; $A047
-SUBSTK	EQU	$1F80	; $A080
-INEEE	EQU	$E1AC
-OUTEEE	EQU	$E1D1
-RESET	EQU	$E0D0
-	ORG	$100
+	ORG	BUFORG
+BUFFER	RMB	$80
+EXSTK	EQU	*
+EXSP	RMB	2
+	RMB	52
+STACK	EQU	$647
+SUBSTK	EQU	$680
 *
+KBREAD	EQU	$F012
+DISP1C	EQU	$F015
+*
+RESET	EQU	$F000
+*
+	ORG	IPRORG
 	JSR	START
 	JMP	CONTRL
 *
 LOADM	BSR	IN
-	CMP A	#2
+	CMPA	#2
 	BNE	LOADM
 	BRA	GL2
 *
-GTLINE	LDA A	LDFLG
+GTLINE	LDAA	LDFLG
 	BNE	LOADM
-	LDA A	AFLG
+	LDAA	AFLG
 	BEQ	GL1
-	LDA A	#10
-	CLR B
+	LDAA	#10
+	CLRB
 	LDX	#LN
 	JSR	ADD3
 	JSR	PNUM
 	JSR	OUTS
-	BRA	GL3
+	JSR	IN
+	CMPA	#$D
+	BNE	GL4
+	JMP	CONTRL
 *
-GL1	LDA A	#'#
+GL1	LDAA	#$23	"#"
 	JSR	OUT
 GL2	LDX	#BUFFER
-GL3	EOR A	RND
-	STA A	RND
+GL3	EORA	RND
+	STAA	RND
 	BSR	IN
-	CMP A	#$D
+	CMPA	#$D	CR
 	BNE	GL4
 	CLR	0,X
 	STX	BUFEND
-	LDA A	LDFLG
+	LDAA	LDFLG
 	BNE	*+5
 NEWL2	JSR	NWLINE
 	LDX	#BUFFER
 	RTS
 *
-GL4	CMP A	#$18
-	BNE	GL5
-	BSR	NEWL2
-	BRA	GL3
-*
-GL5	CMP A	#$F
+GL4	CMPA	#$7F
 	BNE	GL6
-	LDA A	#$5F
-	JSR	OUT
 	CPX	#BUFFER
 	BEQ	GL3
 	DEX
 	BRA	GL3
 *
-GL6	CPX	#BUFFER+70
+GL6	CPX	#BUFFER+$80
 	BEQ	ERR100
-	STA A	0,X
+	STAA	0,X
 	INX
 	BRA	GL3
 *
-ERR100	LDA B	#100
+ERR100	LDAB	#100
 	JMP	ERRMSG
 *
-IN	JSR	INFFF
-	AND A	#$7F
-	BEQ	IN
-	CMP A	#$7F
-	BEQ	IN
-	CMP A	#3
-	BNE	BR6
-	BRA	CONTRL
+IN	JMP	INEEE
 *
-BREAK	PSH A
-*---------------------
-*	LDA A	$8004
-*	BMI	BR5
+BREAK	PSHA
+	JSR	NMICLR
+	JSR	NMISET
+	SEI
+	PULA
+	RTS
 *
-	JSR	POLCAA
-	BCC	BR5
-*---------------------
-	BSR	IN
-BR5	PUL A
-BR6	RTS
-*
 INIT1	LDX	PRSTRT
-	TPA
-	STA A	0,X
+	LDAA	#$FF
+	STAA	0,X
 	INX
-	STA A	0,X
+	STAA	0,X
 	STX	PREND
+	LDX	#CONTRL
+	STX	4
 	RTS
 *
-LOAD	BSR	INIT1
-	STA A	LDFLG
-	BRA	C4
+LOAD	SWI
 *
 AUTO	TPA
-	STA A	AFLG
+	STAA	AFLG
 	JSR	EXPRPP
-	SUB A	#10
-	SBC B	#0
-SETLN	STA A	LN+1
-	STA B	LN
+	SUBA	#10
+	SBCA	#0
+SETLN	STAA	LN+1
+	STAB	LN
 	RTS
 *
 STOP	JSR	PRINT
 	JSR	PSX
 	BRA	C3
 *
-START	LDX	#RAMSSS
+START	EQU	*
+	LDX	#BEGMES
+	JSR	PD
+	LDX	#RAMTOP
 	STX	PRSTRT
-*---------------------
-	NOP
-	NOP
-	NOP
-	NOP
-	NOP
-	NOP
-	NOP
-	NOP
-	NOP
-	NOP
-	NOP
-	NOP
 *
-*	LDA A	#$AA
-*MEMTST	INX
-*	LDA B	1,X
-*	STA A	1,X
-*	LDA A	1,x
-*	STA B	1,X
-*	CMP A	#$AA
-*
-*	BEQ	MEMTST
-*
-	LDX	#RAMEEE
-*----------------------
-	STX	RAMEND
 NEW	BSR	INIT1
 CONTRL	LDS	#STACK
+	JSR	NMISET
 	SEI
-	BSR	INIT2
+	JSR	INIT2
 C3	JSR	NWLINE
 	LDX	#RDYMSG
 	JSR	PD
 	TPA
-	STA A	LNADRS
+	STAA	LNADRS
 C4	LDS	#STACK
 	JSR	GTLINE
 	JSR	GETN
-	BCC	DIRECT
+	BCC	JDIR
 	BSR	SETLN
 	BSR	EDIT
 	BRA	C4
@@ -199,32 +169,33 @@
 	INX
 	TXS
 	LDX	Z
-MOVE1	ASL B
-	PUL B
-	STA B	0,X
+MOVE1	ASLB
+	PULB
+	STAB	0,X
 	INX
 	BPL	MOVE1
 	BCC	MOVE1
 	DEX
 	STX	PREND
 INSERT	LDX	PX
-	LDA A	0,X
+	LDAA	0,X
 	BEQ	INS3
-	LDA A	BUFEND+1
-	SUB A	PX+1
-	ADD A	#3
+	LDAA	BUFEND+1
+	SUBA	PX+1
+	ADDA	#3
 	LDX	PREND
-	ADD A	PREND+1
-	STA A	PREND+1
+	ADDA	PREND+1
+	STAA	PREND+1
 	BCC	*+5
 	INC	PREND
-	BSR	SIZE
+	JSR	SIZE
 	BCC	INS2
 	STX	PREND
-ERR110	LDA B	#110
-	BRA	ERROR
+	BRA	ERR110
 *
-LDTST	LDA A	LDFLG
+JDIR	BRA	DIRECT
+*
+LDTST	LDAA	LDFLG
 	BEQ	LNFD
 	LDX	PREND
 	DEX
@@ -234,8 +205,8 @@
 INS2	LDS	PREND
 	INX
 MOVE2	DEX
-	LDA A	0,X
-	PSH A
+	LDAA	0,X
+	PSHA
 	CPX	Z
 	BNE	MOVE2
 	LDS	LN
@@ -244,8 +215,8 @@
 	LDS	PX
 	DES
 MOVE3	INX
-	PUL A
-	STA A	0,X
+	PULA
+	STAA	0,X
 	BNE	MOVE3
 INS3	LDS	SP
 	RTS
@@ -258,10 +229,14 @@
 	STX	SUBSP
 	LDX	#EXSTK
 	STX	EXSP
+	JSR	NMISET
+	SEI
 	RTS
 *
 DIRECT	STX	PX
-	LDX	#TABLE2-2
+	LDX	#TABLE2
+	DEX
+	DEX
 	BRA	STMT4
 *
 NXTL	INX
@@ -272,35 +247,37 @@
 *
 FINDER	LDX	LNADRS
 	BMI	LNFD
-	BSR	LNFD+2
-	BCC	LNFD3+4
+	BSR	LNFD22
+	BCC	LNFD33
 LNFD	LDX	PRSTRT
-	LDA A	LN+1
-	LDA B	LN
+LNFD22	LDAA	LN+1
+	LDAB	LN
 	BMI	ERR120
 	BNE	LNFD3
-	TST A
+	TSTA
 	BNE	LNFD3
-ERR120	LDA B	#120
+ERR110	LDAB	#110
+	FCB	$7D	:TST
+ERR120	LDAB	#120
 ERROR	JMP	ERRMSG
 *
 	BSR	NXTL
 	INX
 LNFD3	BSR	CMPX
-	BHI	*-5
+LNFD33	BHI	*-5
 	RTS
 *
 IF	JSR	EXPRPP
-	TST B
+	TSTB
 	BNE	STMT3
-	TST A
+	TSTA
 	BEQ	NXTL2
 	BRA	STMT3
 *
-SIZE	LDA A	RAMEND+1
-	LDA B	RAMEND
-	SUB A	PREND+1
-	SBC B	PREND
+SIZE	LDAA	RAMEND+1
+	LDAB	RAMEND
+	SUBA	PREND+1
+	SBCB	PREND
 	RTS
 *
 C7	JMP	C3
@@ -308,57 +285,61 @@
 RUN	BSR	INIT2
 	LDX	PRSTRT
 STMT	STX	LNADRS
-	LDA A	0,X
-	ASL A	,
-	LDA A	LNADRS
-	BLS	C7
+	LDAA	0,X
+	ASLA
+	BCS	C7
+	LDAA	LNADRS
+	CMPA	BUFEND
+	BEQ	C7
 	INX
 	INX
 STMT3	JSR	BREAK
 	STX	PX
-	LDX	#TABLE-2
+	LDX	#TABLE
+	DEX
+	DEX
 STMT4	LDS	#STACK
 	JSR	OPRATE
 	DEX
-STMT5	LDA A	0,X
+STMT5	LDAA	0,X
 	INX
-	CMP A	#':
+	CMPA	#$3A	":"
 	BEQ	STMT3
-	TST A
+	TSTA
 	BNE	STMT5
 	BRA	STMT
 *
-HEXA	CLR B
-	STA B	Z
+HEXA	CLRB
+	STAB	Z
 	BSR	TSTHEX
 	BCC	SIZE
-HEX2	ROL A
-	ASL A
-	ASL A
-	ASL A
-	ASL A
+HEX2	ROLA
+	ASLA
+	ASLA
+	ASLA
+	ASLA
 SHIFT	ROL	Z
-	ROL B
-	ASL A
+	ROLB
+	ASLA
 	BNE	SHIFT
 	INX
 	BSR	TSTHEX
 	BCS	HEX2
-	LDA A	Z
+	LDAA	Z
 	RTS
 *
 TSTHEX	JSR	TSTN
 	BCS	HEX3
-	SUB A	#7
-	CMP A	#$3A
+	SUBA	#7
+	CMPA	#$3A
 	CLC
 	BLT	*+4
-	CMP A	#$40
+	CMPA	#$40	"@"
 HEX3	RTS
 *
-CMPX	CMP B	0,X
+CMPX	CMPB	0,X
 	BNE	*+4
-	CMP A	1,X
+	CMPA	1,X
 	RTS
 *
 SRCH2	STX	PX
@@ -368,12 +349,12 @@
 	DES
 	INX
 S1	INX
-S2	PUL A
-	CMP A	#$20
+S2	PULA
+	CMPA	#$20	" "
 	BEQ	S2
 	TAB
-	SUB A	0,X
-	ASL A
+	SUBA	0,X
+	ASLA
 	BNE	S5
 	BCC	S1
 	INX
@@ -382,12 +363,12 @@
 	LDS	SP
 	RTS
 *
-S5	LDA A	0,X
+S5	LDAA	0,X
 	INX
 	BPL	S5
-	CMP B	#'.
+	CMPB	#$2E	"."
 	BEQ	S4
-	COM A
+	COMA
 	BNE	S0
 	BRA	S3
 *
@@ -396,13 +377,15 @@
 PR3	BSR	PQUOTE
 	BEQ	PR4
 	STX	PX
-	LDX	#TABLE5-2
+	LDX	#TABLE5
+	DEX
+	DEX
 	JSR	OPRATE
 PR4	BSR	SKB9
 	BEQ	PR9
-	CMP A	#';
+	CMPA	#$3B	";"
 	BEQ	PR5
-	CMP A	#',
+	CMPA	#$2C	","
 	BNE	ERR130
 	BSR	PT
 PR5	INX
@@ -415,8 +398,8 @@
 PR9	JMP	NWLINE
 *
 	JSR	OUTS
-PT	LDA A	CHCNT
-	BIT A	#7
+PT	LDAA	CHCNT
+	BITA	#7
 	BNE	PT-3
 	RTS
 *
@@ -424,25 +407,23 @@
 OUT7	JMP	OUT
 *
 TAB	BSR	FACTPP
-	TAB
-	BRA	TAB2
-*
-	JSR	OUTS
-TAB2	CMP B	CHCNT
+	CMPB	$F
+	BCC	TAB2
+	STAB	$F
+TAB2	CMPB	CHCNT
 	BHI	*-5
 	RTS
 *
 PQUOTE	BSR	SKB9
-	CMP A	#'"
+	CMPA	#$22	"""
 	BEQ	*+6
-	CMP A	#''
+	CMPA	#$27	"'"
 	BNE	PQ5
 	TAB
 	INX
 	BRA	*+4
-*
 PQ4	BSR	OUT7
-	LDA A	0,X
+	LDAA	0,X
 	BEQ	ERR130
 	INX
 	CBA
@@ -452,28 +433,27 @@
 FACTPP	JSR	FACT9
 	JMP	POP
 *
-ERR130	LDA B	#130
-	BRA	*+4
+ERR130	LDAB	#130
+	FCB	$7D	:TST
+ERR140	LDAB	#140
+	JMP	ERROR
 *
-ERR140	LDA B	#140
-	JMP	ERRMSG
-*
-DIVIDE	LDA A	0,X
-	ORA A	1,X
+DIVIDE	LDAA	0,X
+	ORAA	1,X
 	BEQ	ERR140
 	BSR	SETCNT
 	BSR	ROL2X
-	ROL A
-	NEG A
+	ROLA
+	NEGA
 	TAB
 	BSR	CHECK
-	ROL A
-	EOR A	#1
-	ROR A
+	ROLA
+	EORA	#1
+	ROLA
 	BSR	DIV3
 	JSR	CMPX
 	BNE	RDIV
-	CLR A
+	CLRA
 	TAB
 	INC	3,X
 	BNE	*+4
@@ -484,10 +464,10 @@
 *
 BINDIV	BSR	SETCNT
 DIV2	BSR	ROL2X
-	ROL A
-	ROL B
-	SUB A	1,X
-	SBC B	0,X
+	ROLA
+	ROLB
+	SUBA	1,X
+	SBCB	0,X
 	BSR	CHECK
 DIV3	DEC	F
 	BNE	DIV2
@@ -495,30 +475,30 @@
 	ROL	2,X
 	RTS
 *
-CHECK	PSH B
-	EOR B	0,X
-	PUL B
+CHECK	PSHB
+	EORB	0,X
+	PULB
 	SEC
 	BPL	*+7
-	ADD A	1,X
-	ADC B	0,X
+	ADDA	1,X
+	ADCB	0,X
 	CLC
 	RTS
 *
-SETCNT	LDA A	#16
-	STA A	F
-	CLR A
+SETCNT	LDAA	#16
+	STAA	F
+	CLRA
 	TAB
 	RTS
 *
 MULT	BSR	SETCNT
-MLT2	ASL A
-	ROL B
+MLT2	ASLA
+	ROLB
 	ROL	1,X
 	ROL	0,X
 	BCC	*+6
-	ADD A	3,X
-	ADC B	2,X
+	ADDA	3,X
+	ADCB	2,X
 	DEC	F
 	BNE	MLT2
 	INX
@@ -530,35 +510,35 @@
 	LDX	#W
 	BSR	ABSX
 	BCC	PN2
-	LDA A	#'-
+	LDAA	#$2D	"-"
 	BSR	OUT
 PN2	DEX
 	DEX
-	LDA B	#10
-	STA B	1,X
+	LDAB	#10
+	STAB	1,X
 	CLR	0,X
-	ASR B
-PN3	PSH B
+	ASRB
+PN3	PSHB
 	BSR	BINDIV
-	PUL B
-	PSH A
-	DEC B
+	PULB
+	PSHA
+	DECB
 	BNE	PN3
 	LDX	#BUFFER
-	LDA B	#4
-PN4	LDA A	F
-	PUL A
+	LDAB	#4
+PN4	LDAA	F
+	PULA
 	BNE	PN5
-	STA A	F
+	STAA	F
 	BEQ	*+4
 PN5	BSR	PN6
-	DEC B
+	DECB
 	BNE	PN4
-	PUL A
-PN6	ADD A	#$30
+	PULA
+PN6	ADDA	#$30	"0"
 	TST	AFLG
 	BEQ	*+5
-	STA A	0,X
+	STAA	0,X
 	INX
 OUT	INC	CHCNT
 	JSR	BREAK
@@ -573,48 +553,47 @@
 RABS	RTS
 *
 SKB2	INX
-SKB	LDA A	0,X
-	CMP A	#$20
+SKB	LDAA	0,X
+	CMPA	#$20	" "
 	BEQ	SKB2
-	TST A
+	TSTA
 	BEQ	*+5
-	CMP A	#':
+	CMPA	#$3A	":"
 	SEC
 	RTS
 *
 EXPR3	BSR	SKB
-	CMP A	#'-
+	CMPA	#$2D	"-"
 	BNE	E3
 	BSR	E9
 	BRA	E5
 *
-E3	CMP A	#'+
+E3	CMPA	#$2B	"+"
 	BEQ	E4
 	DEX
 E4	BSR	TERM2
 E5	LDX	PX
 	BSR	SKB
-	CMP A	#'+
+	CMPA	#$2B	"+"
 	BNE	E6
 	BSR	TERM2
 E55	BSR	ADD
 	BRA	E5
 *
-E6	CMP A	#'-
+E6	CMPA	#$2D	"-"
 	BNE	E7
 	BSR	E9
 	BRA	E55
-*
 E9	BSR	TERM2
 	BRA	NEGX
 *
 ADD	JSR	POP
 	INX
 	INX
-ADD3	ADD A	1,X
-	ADC B	0,X
-STAX	STA A	1,X
-	STA B	0,X
+ADD3	ADDA	1,X
+	ADCB	0,X
+STAX	STAA	1,X
+	STAB	0,X
 E7	RTS
 *
 ABS	JSR	FACT9
@@ -624,32 +603,31 @@
 	RTS
 *
 TSTEQ	BSR	SKB
-	CMP A	#'=
+	CMPA	#$3D	"="
 	BNE	R5
 	INS
 	INS
-	INC B
+	INCB
 	BRA	R3
 *
-REL	CLR B
+REL	CLRB
 	BSR	TSTEQ
 	BSR	R7
 	BNE	R6
 	BSR	TSTEQ
-R2	CMP A	#'>
+R2	CMPA	#$3E	">"
 	BNE	R5
-R3	INC B
-
+R3	INCB
 R4	INX
-	CLR A
+	CLRA
 R5	RTS
 *
 R6	BSR	R2
 	BNE	R5
 	BSR	TSTEQ
-R7	CMP A	#'<
+R7	CMPA	#$3C	"<"
 	BNE	R5
-	ADD B	#4
+	ADDB	#4
 	BRA	R4
 *
 TERM2	BSR	TERM
@@ -659,63 +637,63 @@
 *
 EXPR	BSR	EXPR3
 	BSR	REL
-	TST B
+	TSTB
 	BEQ	R5
-	PSH B
+	PSHB
 	BSR	EXPR3
 	JSR	POP
 	LDX	EXSP
-	SUB A	1,X
-	SBC B	0,X
-	PUL B
+	SUBA	1,X
+	SBCB	0,X
+	PULB
 	BLT	LT
 	BGT	GT
-	TST A
+	TSTA
 	BEQ	EQ
-GT	ASR B
-EQ	ASR B
-LT	AND B	#1
-	STA B	1,X
+GT	ASRB
+EQ	ASRB
+LT	ANDB	#1
+	STAB	1,X
 	CLR	0,X
 	LDX	Z
 	RTS
 *
 GETN	BSR	TSTN
 	BCC	NOTN
-	CLR B
-	STA B	Z+1
-GN2	STA B	Z
-	AND A	#$F
-	STA A	F
-	LDA A	Z+1
-	ASL A
-	ROL B
-	ASL A
-	ROL B
-	ADD A	Z+1
-	ADC B	Z
-	ASL A
-	ROL B
-	ADD A	F
-	STA A	Z+1
-	ADC B	#0
+	CLRB
+	STAB	Z+1
+GN2	STAB	Z
+	ANDA	#$F
+	STAA	F
+	LDAA	Z+1
+	ASLA
+	ROLB
+	ASLA
+	ROLB
+	ADDA	Z+1
+	ADCB	Z
+	ASLA
+	ROLB
+	ADDA	F
+	STAA	Z+1
+	ADCB	#0
 	INX
 	BSR	TSTN
 	BCS	GN2
-	LDA A	Z+1
+	LDAA	Z+1
 	SEC
 NOTN	RTS
 *
 TSTN	JSR	SKB8
-	CMP A	#'0
+	CMPA	#$30	"0"
 	CLC
 	BLT	*+4
-	CMP A	#$3A
+	CMPA	#$3A
 T3	RTS
 *
 TERM	BSR	FACT
 T1	BSR	SKB8
-	CMP A	#'*
+	CMPA	#$2A	"*"
 	BNE	T2
 	BSR	FACT2
 	JSR	MULT
@@ -723,7 +701,7 @@
 	LDX	PX
 	BRA	T1
 *
-T2	CMP A	#'/
+T2	CMPA	#$2F	"/"
 	BNE	T3
 	BSR	FACT2
 	JSR	DIVIDE
@@ -739,31 +717,31 @@
 PEEK	BSR	FACT
 	JSR	POP
 	BSR	TAX
-	LDA A	0,X
-	CLR B
-	BRA	PUSH-2
+	LDAA	0,X
+	CLRB
+	BRA	PUSH22
 *
 FACT	INX
 	BSR	GETN
 	BCS	PUSH
-	CMP A	#'#
+	CMPA	#$23	"#"
 	BEQ	PEEK
-	CMP A	#'$
+	CMPA	#$24	"$"
 	BEQ	HEXA2
 	STX	PX
-	LDX	#TABLE3
+	LDX	#TABLE3-2
 OPRATE	JSR	SEARCH
-	LDA A	1,X
-	PSH A
-	LDA A	0,X
-	PSH A
+	LDAA	1,X
+	PSHA
+	LDAA	0,X
+	PSHA
 	LDX	PX
 	RTS
 *
 FVAR	BSR	TAX
-	LDA A	1,X
-	LDA B	0,X
-	LDX	PX
+	LDAA	1,X
+	LDAB	0,X
+PUSH22	LDX	PX
 PUSH	STX	Z
 	LDX	EXSP
 	DEX
@@ -775,39 +753,37 @@
 	LDX	Z
 	RTS
 *
-ERR150	LDA B	#150
-ER	JMP	ERRMSG
+ERR150	LDAB	#150
+	FCB	$7D	:TST
+ERR160	LDAB	#160
+	FCB	$7D	:TST
+ERR170	LDAB	#170
+	JMP	ERRMSG
 *
-ERR160	LDA B	#160
-	BRA	ER
-*
-ERR170	LDA B	#170
-	BRA	ER
-*
 SKB8	JMP	SKB
 *
 NOTFNC	BSR	TSTV
 	BCC	FVAR
-	LDA A	0,X
-	CMP A	#'(
+	LDAA	0,X
+	CMPA	#$28
 	BNE	ERR160
 	INX
 FACT9	JSR	EXPR
 	BSR	SKB8
-	CMP A	#')
+	CMPA	#$29
 	BNE	ERR160
 	INX
 	RTS
 *
 TAX	STX	PX
-	STA A	Z+1
-	STA B	Z
-	LDx	Z
+	STAA	Z+1
+	STAB	Z
+	LDX	Z
 	RTS
 *
 MOD	JSR	EXPR
-	LDA A	0,X
-	CMP A	#',
+	LDAA	0,X
+	CMPA	#$2C
 	BNE	ERR170
 	INX
 MOD2	BSR	FACT9
@@ -816,96 +792,94 @@
 	JSR	DIVIDE
 	BRA	PUSH2
 *
-RANDOM	LDA A	RND+1
-	LDA B	RND
-	ADD B	RND+1
-	ADC A	#$95
-	ADC B	#$AB
-	STA B	RND+1
-	STA A	RND
+RANDOM	LDAA	RND+1
+	LDAB	RND
+	ADDB	RND+1
+	ADCA	#$95
+	ADCB	#$AB
+	LSRB
+	STAB	RND+1
+	STAA	RND
 	BSR	PUSH
 	BRA	MOD2
 *
 USER	BSR	USER2
-	BRA	PUSH-2
-*
+	BRA	PUSH22
 USER2	BSR	ARG2
-	PSH A
-	PSH B
+	PSHA
+	PSHB
 	BSR	ARG
-	PSH A
-	PSH B
+	PSHA
+	PSHB
 	BSR	ARG
-	PSH A
-	PSH B
+	PSHA
+	PSHB
 	TPA
-	PSH A
+	PSHA
 	BSR	FACT9+3
 	STX	PX
 	RTI
 *
-ARG	LDA A	0,X
-	CMP A	#',
+ARG	LDAA	0,X
+	CMPA	#$2C	","
 	BNE	NONE
 	INX
 ARG2	JMP	EXPRPP
 *
-NONE	CLR A
-	CLR B
+NONE	CLRA
+	CLRB
 	RTS
 *
 TSTV	BSR	SKB8
-	CMP A	#$40
+	CMPA	#$40	"@"
 	BEQ	ARRAY
-	CMP A	#'A
+	CMPA	#$41	"A"
 	BCS	NOTV
-	CMP A	#'Z
+	CMPA	#$5A
 	BHI	NOTV
-	ASL A
-	CLR B
+	ASLA
+	LDAB	BUFEND
 	INX
 	RTS
 *
 ARRAY	JSR	FACT
 	JSR	POP
-	BIT B	#$C0
+	BITB	#$C0
 	BNE	ERR11
 	SEC
-	ROL A
-	ROL B
-	ADD A	PREND+1
-	ADC B	PREND
-	CMP B	RAMEND
+	ROLA
+	ROLB
+	ADDA	PREND+1
+	ADCB	PREND
+	CMPB	RAMEND
 	BNE	*+4
-	CMP A	RAMEND*1
+	CMPA	RAMEND+1
 	BCC	ERR11
 	CLC
 	RTS
-*
 ERR11	JMP	ERR110
 *
 NOTV	SEC
 	RTS
 *
 TSTEQ2	JSR	TSTEQ
-ERR180	LDA B	#180
+ERR180	LDAB	#180
+	FCB	$7D	:TST
+ERR190	LDAB	#190
 ERR19	JMP	ERRMSG
 *
 LET3	JSR	TSTV
 	BCS	ERR180
-LET4	STA A	W+1
-	STA B	W
+LET4	STAA	W+1
+	STAB	W
 	BSR	TSTEQ2
 	BSR	EXPRPP
 	STX	PX
 	LDX	W
 	RTS
 *
-ERR190	LDA B	#190
-	BRA	ERR19
-*
-THEN	CLR B
-	PSH B
+THEN	CLRB
+	PSHB
 	JSR	GETN
 	BCS	GOTO2
 	JMP	STMT3
@@ -943,43 +917,40 @@
 	LDX	EXSP
 	CPX	#EXSTK
 	BEQ	ERR180
-	LDA A	1,X
-	LDA B	0,X
+	LDAA	1,X
+	LDAB	0,X
 	INX
 	INX
 	STX	EXSP
 	LDX	Z
 	RTS
+*
 EXPR9	LDX	PX
 EXPR7	JMP	EXPR
 *
-GOTO	CLR A
-GOSUB	PSH A
+GOTO	CLRA
+GOSUB	PSHA
 	BSR	EXPRPP
 GOTO2	JSR	SETLN
-	PUL A
-	TST A
+	PULA
+	TSTA
 	BEQ	*+4
 	BSR	PSX
 	JSR	FINDER
-	BCC	*+6
-ERR200	LDA B	#200
-	BRA	ERR22
-*
+	BCS	ERR200
 	JMP	STMT
-*
 LET	JSR	SKB
-	CMP A	#'#
+	CMPA	#$23	"#"
 	BEQ	POKE
 LET1	JSR	LET3
-	STA A	1,X
-LET2	STA B	0,X
+	STAA	1,X
+LET2	STAB	0,X
 	LDX	PX
 	RTS
 *
 FOR	BSR	LET1
-	LDA A	W+1
-	LDA B	W
+	LDAA	W+1
+	LDAB	W
 	JSR	PUSH
 	JSR	SRCH2
 	CPX	#TOMSG
@@ -988,34 +959,36 @@
 	JSR	SRCH2
 	CPX	#STPMSG
 	BEQ	FOR1
-	LDA A	#1
-	CLR B
-	JSR	PUSH-2
+	LDAA	#1
+	CLRB
+	JSR	PUSH22
 	BRA	*+4
-*
 FOR1	BSR	EXPR9
 	STX	PX
-	LDA A	PX+1
-	LDA B	PX
+	LDAA	PX+1
+	LDAB	PX
 	JSR	PUSH
-	LDA A	W+1
-	LDA B	W
+	LDAA	W+1
+	LDAB	W
 	LDX	FORSP
 FOR3	BSR	TST2
 	BCC	FOR4
 	LDX	FORSP
 	CPX	#FORSTK-64
-	BNE	FOR4+2
-ERR210	LDA B	#210
-ERR22	JMP	ERRMSG
+	BNE	FOR42
 *
-FOR4	BSR	INX8
-	BSR	FORPSH
+ERR200	LDAB	#200
+	FCB	$7D	:TST
+ERR210	LDAB	#210
+	JMP	ERRMSG
+*
+FOR4	FCB	$EC,$08	:ADX#8
+FOR42	BSR	FORPSH
 	BRA	NEXT5
 *
 TSTSTK	JSR	CMPX
 	BEQ	TST3
-	BSR	INX8
+	FCB	$EC,$08	:ADX#8
 TST2	CPX	#FORSTK
 	BNE	TSTSTK
 	SEC
@@ -1027,50 +1000,43 @@
 	DEX
 	DEX
 STAX2	JMP	STAX
-ERR220	LDA B	#220
-	BRA	ERR22
+ERR220	LDAB	#220
+	JMP	ERRMSG
 *
 NEXT	JSR	TSTV
 	STX	PX
 	LDX	FORSP
 	BCC	*+6
-	LDA A	1,X
-	LDA B	0,X
+	LDAA	1,X
+	LDAB	0,X
 	BSR	TST2
 	BCS	ERR220
 	STX	FORSP
-	LDA A	5,X
-	LDA B	4,X
+	LDAA	5,X
+	LDAB	4,X
 	LDX	0,X
 	JSR	ADD3
 	LDX	FORSP
-	CMP B	2,X
+	CMPB	2,X
 	SEC
 	BLT	NEXT4
 	CLC
 	BGT	NEXT4
-	CMP A	3,X
+	CMPA	3,X
 	BEQ	AGAIN
-NEXT4	ROR A
-	EOR A	4,X
+NEXT4	RORA
+	EORA	4,X
 	BMI	AGAIN
-	BSR	INX8
+	FCB	$EC,$08	:ADX#8
 NEXT5	STX	FORSP
 	LDX	PX
 	RTS
 *
-INX8	BSR	*+2
-	INX
-	INX
-	INX
-	INX
-	RTS
-*
 AGAIN	LDX	6,X
 	RTS
 *
 INPUT	STX	W
-	LDA A	W
+	LDAA	W
 	BEQ	ERR10
 	LDX	BUFEND
 	STX	V
@@ -1080,13 +1046,13 @@
 	BSR	TSTCM
 IN2	JSR	TSTV
 	BCS	ERR10
-	PSH A
-	PSH B
+	PSHA
+	PSHB
 	STX	W
 	LDX	V
 	BSR	SKB1
 	BNE	IN3
-	LDA A	#'?
+	LDAA	#$3F	"?"
 	BSR	OUT3
 	BSR	OUTS
 	JSR	GL2
@@ -1101,7 +1067,7 @@
 	LDX	W
 	BSR	SKB1
 	BEQ	IN4
-	CMP A	#',
+	CMPA	#$2C	","
 	BNE	ERR10
 	INX
 	BRA	IN2
@@ -1113,25 +1079,25 @@
 	INX
 IN4	RTS
 *
-TSTCM2	PSH A
+TSTCM2	PSHA
 	BSR	SKB1
-	CMP A	#',
-	PUL A
+	CMPA	#$2C	","
+	PULA
 	RTS
 *
 SKB1	JMP	SKB
 *
-OUTS	LDA A	#$20
+OUTS	LDAA	#$20	" "
 OUT3	JMP	OUT
 *
-LIST	CLR B
-	LDA A	#1
+LIST	CLRB
+	LDAA	#1
 	JSR	SETLN
-	LDA B	#$7F
-	LDA A	#$FF
-	PSH A
+	LDAB	#$7F
+	LDAA	#$FF
+	PSHA
 	BSR	SKB1
-	PUL A
+	PULA
 	BEQ	LIST2
 	JSR	EXPRPP
 	JSR	SETLN
@@ -1139,8 +1105,8 @@
 	BNE	LIST2
 	INX
 	JSR	EXPRPP
-LIST2	STA A	SP+1
-	STA B	SP
+LIST2	STAA	SP+1
+	STAB	SP
 	LDX	SP
 	BNE	*+7
 	LDX	#32767
@@ -1149,34 +1115,33 @@
 	BRA	*+4
 *
 LIST3	BSR	LISTX
-	LDA A	SP+1
-	LDA B	SP
+	LDAA	SP+1
+	LDAB	SP
 	JSR	CMPX
 	BCC	LIST3
-	LDA A	#3
+	LDAA	#2
 	BSR	OUT3
 C9	JMP	CONTRL
 *
-LISTX	LDA A	#2
+LISTX	LDAA	#2
 	BSR	OUT3
 	BSR	PNUM9
 	INX
-	LDA A	#$20
+	LDAA	#$20
 	BSR	PD2
-NWLINE	STX	Z
-	LDX	#CRLF
-	BSR	PD
-	CLR	CHCNT
-LX2	LDX	Z
 	RTS
+NWLINE	CLR	CHCNT
+	LDAA	#$D
+	JMP	OUTEEE
 *
 PNUM9	STX	Z
 	JSR	PNUM
-	BRA	LX2
+	LDX	Z
+	RTS
 *
 PD2	BSR	OUT3
 	INX
-PD	LDA A	0,X
+PD	LDAA	0,X
 	BNE	PD2
 	INX
 	RTS
@@ -1186,7 +1151,7 @@
 	LDX	#ERR
 	BSR	PD
 	TBA
-	CLR B
+	CLRB
 	BSR	PRACC
 	LDX	LNADRS
 	BMI	C9
@@ -1195,137 +1160,132 @@
 	BRA	C9
 *
 PREXPR	JSR	EXPRPP
-PRACC	PSH A	e
-	PSH B
+PRACC	PSHA
+	PSHB
 	STX	Z
 	TSX
 	BSR	PNUM9+2
-	PUL B
-	PUL A
+	PULB
+	PULA
 	RTS
 *
-N	EQU	$80
 TABLE2	EQU	*
-	FCB	'LIS
-	FCB	N+'T
+	FCC	/LIS/
+	FCB	$D4
 	FDB	LIST
-	FCB	'LOA
-	FCB	N+'D
-	FDB	LOAD
-	FCB	'RU
-	FCB	N+'N
+	FCC	/RU/
+	FCB	$CE
 	FDB	RUN
-	FCB	'E
-	FCB	N+'X
+	FCB	$45,$D8	:EX
 	FDB	RESET
-	FCB	'AUT
-	FCB	N+'O
+	FCC	/AUT/
+	FCB	$CF
 	FDB	AUTO
-	FCB	'NE
-	FCB	N+'W
+	FCC	/NE/
+	FCB	$D7
 	FDB	NEW
+*
 TABLE	EQU	*
-	FCB	'LE
-	FCB	N+'T
+	FCC	/LE/
+	FCB	$D4
 	FDB	LET
-	FCB	'I
-	FCB	N+'F
+	FCB	$49,$C6	:IF
 	FDB	IF
-	FCB	'GOT
-	FCB	N+'O
+	FCC	/GOT/
+	FCB	$CF
 	FDB	GOTO
-	FCB	'GOSU
-	FCB	N+'B
+	FCC	/GOSU/
+	FCB	$C2
 	FDB	GOSUB
-	FCB	'RE
-	FCB	N+'T
+	FCC	/RE/
+	FCB	$D4
 	FDB	PLX
-	FCB	'NEX
-	FCB	N+'T
+	FCC	/NEX/
+	FCB	$D4
 	FDB	NEXT
-	FCB	'FO
-	FCB	N+'R
+	FCC	/FO/
+	FCB	$D2
 	FDB	FOR
-	FCB	'THE
-	FCB	N+'N
+	FCC	/THE/
+	FCB	$CE
 	FDB	THEN
-	FCB	'RE
-	FCB	N+'M
+	FCC	/RE/
+	FCB	$CD
 	FDB	NXTL2
-	FCB	'PRIN
-	FCB	N+'T
+	FCC	/PRIN/
+	FCB	$D4
 	FDB	PRINT
-	FCB	'INPU
-	FCB	N+'T
+	FCC	/INPU/
+	FCB	$D4
 	FDB	INPUT
-	FCB	'P
-	FCB	N+'R
+	FCB	$50,$D2	:PR
 	FDB	PRINT
-	FCB	'I
-	FCB	N+'N
+	FCB	$49,$CE	:IN
 	FDB	INPUT
-	FCB	'STO
-	FCB	N+'P
+	FCC	/STO/
+	FCB	$D0
 	FDB	STOP
-	FCB	'EN
-	FCB	N+'D
+	FCC	/EN/
+	FCB	$C4
 	FDB	CONTRL
 	FCB	$FF
 	FDB	LET
 *
 TABLE3	EQU	*
-	FCB	'RND
-	FCB	N+'(
+	FCC	/RND/
+	FCB	$A8
 	FDB	RANDOM
-	FCB	'ABS
-	FCB	N+'(
+	FCC	/ABS/
+	FCB	$A8
 	FDB	ABS
-	FCB	'MOD
-	FCB	N+'(
+	FCC	/MOD/
+	FCB	$A8
 	FDB	MOD
-	FCB	'USR
-	FCB	N+'(
+	FCC	/USER/
+	FCB	$A8
 	FDB	USER
 	FCB	$FF
 	FDB	NOTFNC
 *
 TABLE4	EQU	*
-	FCB	'T
-	FCB	N+'O
+	FCB	$54,$CF	:TO
 TOMSG	FDB	$1234
-	FCB	'STE
-	FCB	N+'P
+	FCC	/STE/
+	FCB	$D0
 STPMSG	FDB	$ABCD
 *
 TABLE5	EQU	*
-	FCB	'CHR
-	FCB	N+'(
+	FCC	/CHR/
+	FCB	$A8
 	FDB	CHR
-	FCB	'TAB
-	FCB	N+'(
+	FCC	/TAB/
+	FCB	$A8
 	FDB	TAB
 	FCB	$FF
 	FDB	PREXPR
 *
 ERR	FCC	/ERROR /
-	FCB	0
-RDYMSG	FCC	/READY/
-*----------------------
-*CRLF       FCB      $0D,$0A,$FF,$FF,$FF,$FF,$FF,0
+	FCB	7,0
+RDYMSG	FCC	/OK/
+CRLF	FCB	$D,0
+	FDB	$FFFF
+	FDB	$FFFF
+	FDB	$FF00
 *
-CRLF	FCB	$0D,$0A,0
+INEEE	LDAA	#$5F
+	JSR	KBREAD
+	CMPA	#$D
+	BEQ	INRTS
+	JSR	OUTEEE
+INRTS	RTS
 *
-POLCAA	LDAA	ACIACS
-	ASRA
+OUTEEE	JSR	DISP1C
+	SEI
 	RTS
-*----------------------
-INFFF	JSR	INEEE
-	CMP A	#$60
-	BCS	*+4
-	SUB A	#$20
-	CMP A	#$25
-	BNE	*+4
-	LDA A	#$40
-	RTS
 *
+BEGMES	FCB	$C
+	FCC	/HITACHI MB-6881 DENDAI TINY BASIC VER 1.0/
+	FCB	$D
+	FCC	/PORTING BY TEWSOFT. 1981/
+	FCB	$D,$D,0
 	END
